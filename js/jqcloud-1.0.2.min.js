/*!
 * jQCloud Plugin for jQuery
 *
 * Version 1.0.2
 *
 * Copyright 2011, Luca Ongaro
 * Licensed under the MIT license.
 *
 * Date: Tue Oct 09 22:08:53 +0200 2012
*/
(function(g){g.fn.jQCloud=function(c,b){var d=this,w=d.attr("id")||Math.floor(1E6*Math.random()).toString(36),t={width:d.width(),height:d.height(),center:{x:(b&&b.width?b.width:d.width())/2,y:(b&&b.height?b.height:d.height())/2},delayedMode:50<c.length,shape:!1,encodeURI:!0},b=g.extend(t,b||{});d.addClass("jqcloud").width(b.width).height(b.height);"static"===d.css("position")&&d.css("position","relative");var x=function(){for(var t=function(b,a){for(var c=0,c=0;c<a.length;c++){var e;e=b;var d=a[c];
e=Math.abs(2*e.offsetLeft+e.offsetWidth-2*d.offsetLeft-d.offsetWidth)<e.offsetWidth+d.offsetWidth&&Math.abs(2*e.offsetTop+e.offsetHeight-2*d.offsetTop-d.offsetHeight)<e.offsetHeight+d.offsetHeight?!0:!1;if(e)return!0}return!1},j=0;j<c.length;j++)c[j].weight=parseFloat(c[j].weight,10);c.sort(function(b,a){return b.weight<a.weight?1:b.weight>a.weight?-1:0});var k="rectangular"===b.shape?18:2,u=[],r=b.width/b.height,v=function(i,a){var j=w+"_word_"+i,e=6.28*Math.random(),q=0,m=0,s=0,n=5,o="",h="",l=
"";a.html=g.extend(a.html,{id:j});a.html&&a.html["class"]&&(o=a.html["class"],delete a.html["class"]);c[0].weight>c[c.length-1].weight&&(n=Math.round(9*((a.weight-c[c.length-1].weight)/(c[0].weight-c[c.length-1].weight)))+1);l=g("<span>").attr(a.html).addClass("w"+n+" "+o);a.link="#s="+a.text;a.link?("string"===typeof a.link&&(a.link={href:a.link}),b.encodeURI&&(a.link=g.extend(a.link,{href:encodeURI(a.link.href).replace(/'/g,"%27")})),h=g('<a title="'+a.text+'">').attr(a.link).text(a.text)):h=a.text;
l.append(h);if(a.handlers)for(var f in a.handlers)a.handlers.hasOwnProperty(f)&&"function"===typeof a.handlers[f]&&g(l).bind(f,a.handlers[f]);d.append(l);n=l.width();o=l.height();h=b.center.x-n/2;f=b.center.y-o/2;var p=l[0].style;p.position="absolute";p.left=h+"px";for(p.top=f+"px";t(document.getElementById(j),u);){if("rectangular"===b.shape){m++;if(m*k>(1+Math.floor(s/2))*k*(0===s%4%2?1:r))m=0,s++;switch(s%4){case 1:h+=k*r+2*Math.random();break;case 2:f-=k+2*Math.random();break;case 3:h-=k*r+2*Math.random();
break;case 0:f+=k+2*Math.random()}}else q+=k,e+=(0===i%2?1:-1)*k,h=b.center.x-n/2+q*Math.cos(e)*r,f=b.center.y+q*Math.sin(e)-o/2;p.left=h+"px";p.top=f+"px"}u.push(document.getElementById(j));g.isFunction(a.afterWordRender)&&a.afterWordRender.call(l)},m=function(i){i=i||0;d.is(":visible")?i<c.length?(v(i,c[i]),setTimeout(function(){m(i+1)},10)):g.isFunction(b.afterCloudRender)&&b.afterCloudRender.call(d):setTimeout(function(){m(i)},10)};b.delayedMode?m():(g.each(c,v),g.isFunction(b.afterCloudRender)&&
b.afterCloudRender.call(d))};setTimeout(function(){x()},10);return d}})(jQuery);